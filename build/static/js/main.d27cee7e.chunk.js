(this.webpackJsonpcrew=this.webpackJsonpcrew||[]).push([[0],{10:function(e,t,c){e.exports={editSearcher:"AddSearcher_editSearcher__3WV-a",header:"AddSearcher_header__LVF8j",back:"AddSearcher_back__z1VRF",form:"AddSearcher_form__mZG1g"}},114:function(e,t){},115:function(e,t){},133:function(e,t,c){"use strict";c.r(t);var r=c(1),a=c.n(r),s=c(51),n=c.n(s),i=(c(57),c(8)),l=c(9),d=c(3),o=c(17),j=c(11),h=c.n(j),u=c(0),b=new h.a({apiKey:"keyHvrSKnN3fo7ORx"}).base("appou4euyZ2UDPPEg"),O=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),c=t[0],a=t[1],s=Object(r.useState)([]),n=Object(i.a)(s,2),d=n[0],j=n[1];Object(r.useEffect)((function(){b("Quests").select().all((function(e,t){var c=t.map((function(e){return e.fields}));a(c)}))}),[]);return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Quests"}),Object(u.jsxs)("div",{children:["Link ",Object(u.jsx)("br",{}),Object(u.jsx)("input",{value:d,onChange:function(e){return j(e.target.value)}})]}),Object(u.jsx)("button",{onClick:function(){return e=d,void b("Quests").create([{fields:{quest_id:20000003,full_name:"\u0425\u0430\u0440\u043e\u043d\u043e\u0432 \u0425\u0430\u0440\u043e\u043d \u0425\u0430\u0440\u043e\u043d\u043e\u0432\u0438\u0447",chat_link:e}}],(function(e,t){if(e)console.error(e);else{var r=t.map((function(e){return e.fields}))[0];a([].concat(Object(o.a)(c),[r]))}}));var e},children:"Add Quest"}),Object(u.jsx)("ul",{children:c&&c.map((function(e){return Object(u.jsx)("li",{children:Object(u.jsx)(l.b,{to:"/crew?quest_id="+e.quest_id,children:e.full_name})},e.quest_id)}))})]})},_=c(2),f=c.n(_),x=c.p+"static/media/back.a12e73f8.svg",m=(c.p,c(15)),p=c.p+"static/media/pilot.fd0a23e8.svg",g=c.p+"static/media/time.61c1fb73.svg",v=c.p+"static/media/place.ac853a25.svg";function S(e){var t=e.searcher,c=e.getTime,r=e.toggleModal,a=e.lite,s=void 0!==a&&a,n=t.searcher_role,i=t.searcher_phone,l=t.searcher_time,d=t.call_sign,o=t.searcher_place;return Object(u.jsxs)("div",{onClick:function(){return r(t)},className:f.a.searcher,children:[Object(u.jsxs)("div",{className:f.a.searcherHeader,children:[Object(u.jsxs)("div",{className:f.a.searcherCallSign,children:[d,n.includes("\u043f\u0438\u043b\u043e\u0442")?Object(u.jsxs)("span",{className:f.a.isPilot,children:[Object(u.jsx)("img",{src:p,alt:""})," "]}):""]}),Object(u.jsx)("div",{children:i})]}),!s&&Object(u.jsxs)("div",{className:f.a.searcherBody,children:[Object(u.jsxs)("div",{children:[Object(u.jsx)("span",{children:Object(u.jsx)("img",{src:v})}),Object(u.jsx)("span",{children:o})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("span",{children:Object(u.jsx)("img",{src:g})}),Object(u.jsx)("span",{children:c(l)})]})]})]})}function y(e){var t=e.crews,c=e.toggleModal;return Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:f.a.separator}),Object(u.jsx)("h3",{children:"\u0418\u043d\u0444\u043e\u0440\u0433\u0438:"}),t.inforgs&&t.inforgs.map((function(e){return Object(u.jsx)(S,{toggleModal:c,lite:!0,searcher:e})}))]})}function w(e){var t=e.crews,c=e.setSelected,r=e.selectedSearchers,a=e.toggleModal;function s(e){var t=new Date(e),c=new Date,r=new Date;return r.setDate(r.getDate()+1),(c.toLocaleDateString()===t.toLocaleDateString()?"\u0421\u0435\u0433\u043e\u0434\u043d\u044f":r.toLocaleDateString()===t.toLocaleDateString()?"\u0417\u0430\u0432\u0442\u0440\u0430":t.toLocaleDateString())+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function n(e){var t=Object(o.a)(r),a=r.indexOf(e);-1===a?t.push(e):t.splice(a,1),c(t)}return Object(u.jsx)("div",{className:f.a.status,children:t&&t.statuses&&Object.keys(t.statuses).map((function(e){if(t.statuses[e].length>0){var c="\u0433\u043e\u0442\u043e\u0432"!==e&&"\u0432 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443"!==e;return"\u0432 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443"===e?Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:f.a.separator}),Object(u.jsx)("h3",{children:"\u0412 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443:"}),t.crews&&t.crews.map((function(e,t){return Object(u.jsxs)("div",{children:[e.length>0&&Object(u.jsx)("h4",{children:0===t?"\u0416\u0434\u0443\u0442 \u044d\u043a\u0438\u043f\u0430\u0436":"\u042d\u043a\u0438\u043f\u0430\u0436 #"+t}),e&&e.map((function(e){return e&&Object(u.jsx)(S,{lite:c,toggleModal:a,searcher:e,getTime:s,select:n})}))]})}))]}):Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:f.a.separator}),Object(u.jsxs)("h3",{children:[e,":"]}),t.statuses[e]&&t.statuses[e].map((function(e){return e&&Object(u.jsx)(S,{lite:c,toggleModal:a,searcher:e,getTime:s,select:n})}))]})}}))})}var N={currentQuest:[],get crews(){var e=this,t=[[]];return Object(o.a)(new Set(this.statuses["\u0432 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443"].map((function(e){return e.searcher_crew})))).forEach((function(c){0===c?t[0]=e.statuses["\u0432 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443"].filter((function(e){return e.searcher_crew===c})):t.push(e.statuses["\u0432 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443"].filter((function(e){return e.searcher_crew===c})))})),t},get inforgs(){return this.currentQuest.filter((function(e){return e.searcher_role.includes("\u0438\u043d\u0444\u043e\u0440\u0433")}))},get snm(){return this.currentQuest.filter((function(e){return e.searcher_role.includes("\u0441\u043d\u043c")}))},get coord(){return this.currentQuest.filter((function(e){return e.searcher_role.includes("\u043a\u043e\u043e\u0440\u0434")}))},get statuses(){var e={"\u0433\u043e\u0442\u043e\u0432":[],"\u0432 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443":[],"\u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0435":[],"\u0432 \u043f\u0443\u0442\u0438 \u0434\u043e\u043c\u043e\u0439":[],"\u0434\u043e\u043c\u0430":[]};return this.currentQuest.forEach((function(t){("\u0433\u043e\u0442\u043e\u0432"!==t.searcher_status||t.searcher_role.includes("\u043f\u0438\u043b\u043e\u0442")||t.searcher_role.includes("\u043f\u0435\u0448\u0438\u0439"))&&e[t.searcher_status].push(t)})),e}};function k(e){var t=e.questID,c=e.toggleModal,a=Object(r.useState)({}),s=Object(i.a)(a,2),n=s[0],l=s[1],d=Object(r.useState)([]),o=Object(i.a)(d,2),j=o[0],b=o[1],O=new h.a({apiKey:"keyHvrSKnN3fo7ORx"}).base("appou4euyZ2UDPPEg");return Object(r.useEffect)((function(){O("Searchers").select().all((function(e,c){var r=c.map((function(e){return Object(m.a)(Object(m.a)({},e.fields),{},{searchers_table_id:e.id})}));O("CrewMeta").select({filterByFormula:"{quest_id} = ".concat(t)}).all((function(e,t){N.currentQuest=t.map((function(e){return Object(m.a)(Object(m.a)({},e.fields),{},{meta_table_id:e.id},r.find((function(t){return t.searcher_id===e.fields.searcher_id})))})),console.log(N),l(Object(m.a)({},N))}))}))}),[]),Object(u.jsxs)("div",{children:[Object(u.jsx)(y,{toggleModal:c,crews:n}),Object(u.jsx)(w,{toggleModal:c,crews:n,setSelected:b,selectedSearchers:j}),Object(u.jsxs)("div",{children:[j&&j.map((function(e){return Object(u.jsx)("div",{children:e.call_sign})})),Object(u.jsx)("button",{onClick:function(){O("CrewMeta").update([],(function(e,t){t.forEach((function(e){N.currentQuest.find((function(t){return t.meta_table_id===e.id})).searcher_status=e.fields.searcher_status,l(Object(m.a)({},N))}))}))},children:"\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0432 \u044d\u043a\u0438\u043f\u0430\u0436"})]})]})}var D=c(10),C=c.n(D),B=new h.a({apiKey:"keyHvrSKnN3fo7ORx"}).base("appou4euyZ2UDPPEg"),E=function(){var e=Object(d.f)();Object(r.useEffect)((function(){document.body.style.overflowY="auto"}),[]);var t=new URLSearchParams(Object(d.g)().search).get("quest_id");return Object(u.jsxs)("div",{className:C.a.editSearcher,children:[Object(u.jsxs)("div",{className:C.a.header,children:[Object(u.jsx)("div",{className:C.a.back,onClick:function(){return e.goBack()},children:Object(u.jsx)("img",{src:x,alt:"back"})}),Object(u.jsx)("h1",{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]}),Object(u.jsx)("div",{children:Object(u.jsxs)("form",{className:C.a.form,onSubmit:function(e){return function(e){e.preventDefault();var c=Object.fromEntries(new FormData(e.target)),r=new Date(c.searcher_time).toISOString(),a={quest_id:parseInt(t),searcher_crew:0,searcher_id:parseInt(c.searcher_id),searcher_place:c.searcher_place,searcher_role:[c.searcher_role],searcher_status:"\u0433\u043e\u0442\u043e\u0432",searcher_time:r},s={searcher_id:parseInt(c.searcher_id),searcher_phone:c.searcher_phone,call_sign:c.call_sign};B("CrewMeta").create([{fields:a}],(function(e,t){e?console.error(e):t.forEach((function(e){console.log(e.getId())}))})),B("Searchers").create([{fields:s}],(function(e,t){e?console.error(e):t.forEach((function(e){console.log(e.getId())}))}))}(e)},children:[Object(u.jsxs)("label",{children:["\u041f\u043e\u0437\u044b\u0432\u043d\u043e\u0439:",Object(u.jsx)("input",{type:"text",name:"call_sign"})]}),Object(u.jsxs)("label",{children:["@id:",Object(u.jsx)("input",{type:"number",name:"searcher_id"})]}),Object(u.jsxs)("label",{children:["\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430:",Object(u.jsx)("input",{type:"phone",name:"searcher_phone"})]}),Object(u.jsxs)("label",{children:["\u0410\u0434\u0440\u0435\u0441:",Object(u.jsx)("input",{type:"adress",name:"searcher_place"})]}),Object(u.jsxs)("label",{children:["\u0412\u0440\u0435\u043c\u044f:",Object(u.jsx)("input",{type:"datetime-local",name:"searcher_time"})]}),Object(u.jsxs)("label",{children:["\u0420\u043e\u043b\u044c:",Object(u.jsxs)("select",{name:"searcher_role",children:[Object(u.jsx)("option",{selected:!0,value:"\u043f\u0435\u0448\u0438\u0439",children:"\u041f\u0435\u0448\u0438\u0439"}),Object(u.jsx)("option",{value:"\u043f\u0438\u043b\u043e\u0442",children:"\u041f\u0438\u043b\u043e\u0442"}),Object(u.jsx)("option",{value:"\u0438\u043d\u0444\u043e\u0440\u0433",children:"\u0418\u043d\u0444\u043e\u0440\u0433"}),Object(u.jsx)("option",{value:"\u0441\u043d\u043c",children:"\u0421\u041d\u041c"}),Object(u.jsx)("option",{value:"\u043a\u043e\u043e\u0440\u0434",children:"\u041a\u043e\u043e\u0440\u0434"})]})]}),Object(u.jsx)("input",{type:"submit",value:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]})})]})},I=function(e){var t=e.setSearcherData,c=Object(r.useState)(!1),a=Object(i.a)(c,2),s=(a[0],a[1],Object(r.useState)([])),n=Object(i.a)(s,2),o=n[0],j=n[1],h=Object(d.f)(),b=function(e){var c=e.searcher;return Object(u.jsx)("div",{className:f.a.modal,children:Object(u.jsxs)("div",{className:f.a.modalWrapper,children:[Object(u.jsxs)("div",{className:f.a.modalHeader,children:[Object(u.jsx)("h3",{children:c.call_sign}),Object(u.jsx)("div",{className:f.a.modalClose,onClick:function(){return O()},children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]}),Object(u.jsx)("div",{className:f.a.modalSearcherBody,children:Object(u.jsxs)("div",{children:[Object(u.jsx)("span",{children:Object(u.jsx)("img",{src:v})}),Object(u.jsx)("span",{children:c.searcher_place})]})}),Object(u.jsx)("div",{children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{className:f.a.modalButton,children:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441"}),Object(u.jsx)("li",{children:Object(u.jsx)(l.b,{className:f.a.modalButton,onClick:function(){return t(c)},to:"/edit_searcher?quest_id="+_,children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),Object(u.jsx)("li",{className:f.a.modalButton,children:"\u0412 \u044d\u043a\u0438\u043f\u0430\u0436"}),Object(u.jsx)("li",{className:f.a.modalButton,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})})]})})},O=function(e){console.log(o),o[0]?(document.body.style.overflowY="auto",j([!1])):(document.body.style.overflowY="hidden",j([!0,e]))};var _=new URLSearchParams(Object(d.g)().search).get("quest_id");return Object(u.jsxs)("div",{className:f.a.searchers,children:[o[0]&&Object(u.jsx)(b,{searcher:o[1]}),Object(u.jsxs)("div",{className:f.a.header,children:[Object(u.jsx)("div",{className:f.a.back,onClick:function(){return h.goBack()},children:Object(u.jsx)("img",{src:x,alt:"back"})}),Object(u.jsx)("h1",{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u0430"})]}),Object(u.jsx)("div",{children:Object(u.jsx)(l.b,{className:f.a.addSearcher,to:"/add_searcher?quest_id="+_,children:"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u0438\u043a\u0430"})}),Object(u.jsx)(k,{questID:_,toggleModal:O})]})},P=new h.a({apiKey:"keyHvrSKnN3fo7ORx"}).base("appou4euyZ2UDPPEg"),M=function(e){var t=e.searcherData,c=(e.setSearcherData,Object(d.f)());console.log(t),Object(r.useEffect)((function(){document.body.style.overflowY="auto"}),[]);var a=new URLSearchParams(Object(d.g)().search).get("quest_id");return Object(u.jsxs)("div",{className:C.a.editSearcher,children:[Object(u.jsxs)("div",{className:C.a.header,children:[Object(u.jsx)("div",{className:C.a.back,onClick:function(){return c.goBack()},children:Object(u.jsx)("img",{src:x,alt:"back"})}),Object(u.jsx)("h1",{children:"\u0420\u0435\u0434\u0430\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]}),Object(u.jsx)("div",{children:Object(u.jsxs)("form",{className:C.a.form,onSubmit:function(e){return function(e){e.preventDefault();var c=Object.fromEntries(new FormData(e.target)),r=new Date(c.searcher_time).toISOString(),s={quest_id:parseInt(a),searcher_id:parseInt(c.searcher_id),searcher_place:c.searcher_place,searcher_role:[c.searcher_role],searcher_time:r},n={searcher_id:parseInt(c.searcher_id),searcher_phone:c.searcher_phone,call_sign:c.call_sign};P("CrewMeta").update([{id:t.meta_table_id,fields:s}],(function(e,t){e?console.error(e):t.forEach((function(e){console.log(e.getId())}))})),P("Searchers").update([{id:t.searchers_table_id,fields:n}],(function(e,t){e?console.error(e):t.forEach((function(e){console.log(e.getId())}))}))}(e)},children:[Object(u.jsxs)("label",{children:["\u041f\u043e\u0437\u044b\u0432\u043d\u043e\u0439:",Object(u.jsx)("input",{type:"text",name:"call_sign",defaultValue:t.call_sign})]}),Object(u.jsxs)("label",{children:["@id:",Object(u.jsx)("input",{type:"number",name:"searcher_id",defaultValue:t.searcher_id})]}),Object(u.jsxs)("label",{children:["\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430:",Object(u.jsx)("input",{type:"phone",name:"searcher_phone",defaultValue:t.searcher_phone})]}),Object(u.jsxs)("label",{children:["\u0410\u0434\u0440\u0435\u0441:",Object(u.jsx)("input",{type:"text",name:"searcher_place",defaultValue:t.searcher_place})]}),Object(u.jsxs)("label",{children:["\u0412\u0440\u0435\u043c\u044f:",Object(u.jsx)("input",{type:"datetime-local",name:"searcher_time",defaultValue:t.searcher_time.substring(0,16)})]}),Object(u.jsxs)("label",{children:["\u0420\u043e\u043b\u044c:",Object(u.jsxs)("select",{name:"searcher_role",multiple:!1,defaultValue:t.searcher_role,children:[Object(u.jsx)("option",{value:"\u043f\u0435\u0448\u0438\u0439",children:"\u041f\u0435\u0448\u0438\u0439"}),Object(u.jsx)("option",{value:"\u043f\u0438\u043b\u043e\u0442",children:"\u041f\u0438\u043b\u043e\u0442"}),Object(u.jsx)("option",{value:"\u0438\u043d\u0444\u043e\u0440\u0433",children:"\u0418\u043d\u0444\u043e\u0440\u0433"}),Object(u.jsx)("option",{value:"\u0441\u043d\u043c",children:"\u0421\u041d\u041c"}),Object(u.jsx)("option",{value:"\u043a\u043e\u043e\u0440\u0434",children:"\u041a\u043e\u043e\u0440\u0434"})]})]}),Object(u.jsx)("input",{type:"submit",value:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})})]})},q=function(){var e=Object(r.useState)({}),t=Object(i.a)(e,2),c=t[0],a=t[1];return Object(u.jsx)(l.a,{children:Object(u.jsxs)(d.c,{children:[Object(u.jsx)(d.a,{path:"/",exact:!0,children:Object(u.jsx)(O,{})}),Object(u.jsx)(d.a,{path:"/crew",children:Object(u.jsx)(I,{setSearcherData:a})}),Object(u.jsx)(d.a,{path:"/add_searcher",children:Object(u.jsx)(E,{})}),Object(u.jsx)(d.a,{path:"/edit_searcher",children:Object(u.jsx)(M,{searcherData:c,setSearcherData:c})})]})})},L=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,134)).then((function(t){var c=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,n=t.getTTFB;c(e),r(e),a(e),s(e),n(e)}))};n.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(q,{})}),document.getElementById("root")),L()},2:function(e,t,c){e.exports={searchers:"Searchers_searchers__Va7jF",searcher:"Searchers_searcher__2jZ6l",separator:"Searchers_separator__3TIE7",searcherHeader:"Searchers_searcherHeader__26FAq",searcherBody:"Searchers_searcherBody__Yn6VV",modalSearcherBody:"Searchers_modalSearcherBody__1wNF6",searcherCallSign:"Searchers_searcherCallSign__2TlQu",isPilot:"Searchers_isPilot__1KrHB",back:"Searchers_back__3CnuC",status:"Searchers_status__BD_B1",selected:"Searchers_selected__kzEKR",header:"Searchers_header__1dNKN",addSearcher:"Searchers_addSearcher__3RBhX",modal:"Searchers_modal__33dOh",modalWrapper:"Searchers_modalWrapper__k_y_L",modalButton:"Searchers_modalButton__2fZKM",modalClose:"Searchers_modalClose__iP7Jp",modalHeader:"Searchers_modalHeader__zfvkV"}},57:function(e,t,c){}},[[133,1,2]]]);
//# sourceMappingURL=main.d27cee7e.chunk.js.map