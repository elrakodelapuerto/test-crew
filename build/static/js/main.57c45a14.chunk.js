(this.webpackJsonpcrew=this.webpackJsonpcrew||[]).push([[0],{114:function(e,r){},115:function(e,r){},133:function(e,r,t){"use strict";t.r(r);var c=t(1),s=t.n(c),a=t(51),n=t.n(a),i=(t(57),t(9)),l=t(3),d=t(15),o=t(8),j=t(14),h=t.n(j),u=t(0),b=new h.a({apiKey:"keyHvrSKnN3fo7ORx"}).base("appou4euyZ2UDPPEg"),O=function(){var e=Object(c.useState)([]),r=Object(o.a)(e,2),t=r[0],s=r[1],a=Object(c.useState)([]),n=Object(o.a)(a,2),l=n[0],j=n[1];Object(c.useEffect)((function(){b("Quests").select().all((function(e,r){var t=r.map((function(e){return e.fields}));s(t)}))}),[]);return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Quests"}),Object(u.jsxs)("div",{children:["Link ",Object(u.jsx)("br",{}),Object(u.jsx)("input",{value:l,onChange:function(e){return j(e.target.value)}})]}),Object(u.jsx)("button",{onClick:function(){return e=l,void b("Quests").create([{fields:{quest_id:20000003,full_name:"\u0425\u0430\u0440\u043e\u043d\u043e\u0432 \u0425\u0430\u0440\u043e\u043d \u0425\u0430\u0440\u043e\u043d\u043e\u0432\u0438\u0447",chat_link:e}}],(function(e,r){if(e)console.error(e);else{var c=r.map((function(e){return e.fields}))[0];s([].concat(Object(d.a)(t),[c]))}}));var e},children:"Add Quest"}),Object(u.jsx)("ul",{children:t&&t.map((function(e){return Object(u.jsx)("li",{children:Object(u.jsx)(i.b,{to:"/crew?quest_id="+e.quest_id,children:e.full_name})},e.quest_id)}))})]})},_=t(2),f=t.n(_),x=t.p+"static/media/back.a12e73f8.svg",m=(t.p,t(19));function p(e){var r=e.crews;return Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:f.a.separator}),Object(u.jsx)("h3",{children:"\u0418\u043d\u0444\u043e\u0440\u0433\u0438:"}),r.inforgs&&r.inforgs.map((function(e){var r=e.searcher_phone,t=e.call_sign;return Object(u.jsx)("div",{className:f.a.searcher,children:Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{children:t}),Object(u.jsx)("div",{children:r})]})})}))]})}var v=t.p+"static/media/pilot.fd0a23e8.svg";function g(e){e.select;var r=e.searcher,t=e.getTime,c=e.toggleModal,s=r.searcher_role,a=r.searcher_phone,n=r.searcher_time,i=r.call_sign,l=r.searcher_place;return Object(u.jsxs)("div",{onClick:function(){return c(r)},className:f.a.searcher,children:[Object(u.jsxs)("div",{className:f.a.searcherHeader,children:[Object(u.jsxs)("div",{className:f.a.searcherCallSign,children:[i,s.includes("\u043f\u0438\u043b\u043e\u0442")?Object(u.jsxs)("span",{className:f.a.isPilot,children:[Object(u.jsx)("img",{src:v,alt:""})," "]}):""]}),Object(u.jsx)("div",{children:a})]}),Object(u.jsxs)("div",{className:f.a.searcherBody,children:[Object(u.jsx)("div",{children:l}),Object(u.jsx)("div",{children:t(n)})]})]})}function S(e){var r=e.crews,t=e.setSelected,c=e.selectedSearchers,s=e.toggleModal;function a(e){var r=new Date(e),t=new Date,c=new Date;return c.setDate(c.getDate()+1),(t.toLocaleDateString()===r.toLocaleDateString()?"\u0421\u0435\u0433\u043e\u0434\u043d\u044f":c.toLocaleDateString()===r.toLocaleDateString()?"\u0417\u0430\u0432\u0442\u0440\u0430":r.toLocaleDateString())+" "+r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function n(e){var r=Object(d.a)(c),s=c.indexOf(e);-1===s?r.push(e):r.splice(s,1),t(r)}return Object(u.jsx)("div",{className:f.a.status,children:r&&r.statuses&&Object.keys(r.statuses).map((function(e){if(r.statuses[e].length>0)return"\u0432 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443"===e?Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:f.a.separator}),Object(u.jsx)("h3",{children:"\u0412 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443:"}),r.crews&&r.crews.map((function(e,r){return Object(u.jsxs)("div",{children:[e.length>0&&Object(u.jsx)("h4",{children:0===r?"\u0416\u0434\u0443\u0442 \u044d\u043a\u0438\u043f\u0430\u0436":"\u042d\u043a\u0438\u043f\u0430\u0436 #"+r}),e&&e.map((function(e){return e&&Object(u.jsx)(g,{toggleModal:s,searcher:e,getTime:a,select:n})}))]})}))]}):Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:f.a.separator}),Object(u.jsxs)("h3",{children:[e,":"]}),r.statuses[e]&&r.statuses[e].map((function(e){return e&&Object(u.jsx)(g,{toggleModal:s,searcher:e,getTime:a,select:n})}))]})}))})}var w={currentQuest:[],get crews(){var e=this,r=[[]];return Object(d.a)(new Set(this.statuses["\u0432 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443"].map((function(e){return e.searcher_crew})))).forEach((function(t){0===t?r[0]=e.statuses["\u0432 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443"].filter((function(e){return e.searcher_crew===t})):r.push(e.statuses["\u0432 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443"].filter((function(e){return e.searcher_crew===t})))})),r},get inforgs(){return this.currentQuest.filter((function(e){return e.searcher_role.includes("\u0438\u043d\u0444\u043e\u0440\u0433")}))},get snm(){return this.currentQuest.filter((function(e){return e.searcher_role.includes("\u0441\u043d\u043c")}))},get coord(){return this.currentQuest.filter((function(e){return e.searcher_role.includes("\u043a\u043e\u043e\u0440\u0434")}))},get statuses(){var e={"\u0433\u043e\u0442\u043e\u0432":[],"\u0432 \u043f\u0443\u0442\u0438 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443":[],"\u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0435":[],"\u0432 \u043f\u0443\u0442\u0438 \u0434\u043e\u043c\u043e\u0439":[],"\u0434\u043e\u043c\u0430":[]};return this.currentQuest.forEach((function(r){("\u0433\u043e\u0442\u043e\u0432"!==r.searcher_status||r.searcher_role.includes("\u043f\u0438\u043b\u043e\u0442")||r.searcher_role.includes("\u043f\u0435\u0448\u0438\u0439"))&&e[r.searcher_status].push(r)})),e}};function k(e){var r=e.questID,t=e.toggleModal,s=Object(c.useState)({}),a=Object(o.a)(s,2),n=a[0],i=a[1],l=Object(c.useState)([]),d=Object(o.a)(l,2),j=d[0],b=d[1],O=new h.a({apiKey:"keyHvrSKnN3fo7ORx"}).base("appou4euyZ2UDPPEg");return Object(c.useEffect)((function(){O("Searchers").select().all((function(e,t){var c=t.map((function(e){return e.fields}));O("CrewMeta").select({filterByFormula:"{quest_id} = ".concat(r)}).all((function(e,r){w.currentQuest=r.map((function(e){return Object(m.a)(Object(m.a)({},e.fields),{},{table_id:e.id},c.find((function(r){return r.searcher_id===e.fields.searcher_id})))})),console.log(w),i(Object(m.a)({},w))}))}))}),[]),Object(u.jsxs)("div",{children:[Object(u.jsx)(p,{crews:n}),Object(u.jsx)(S,{toggleModal:t,crews:n,setSelected:b,selectedSearchers:j}),Object(u.jsxs)("div",{children:[j&&j.map((function(e){return Object(u.jsx)("div",{children:e.call_sign})})),Object(u.jsx)("button",{onClick:function(){return function(){var e=[];j.forEach((function(r){console.log(r),e.push({id:r.table_id,fields:{searcher_status:"\u0433\u043e\u0442\u043e\u0432"}})})),O("CrewMeta").update(e,(function(e,r){r.forEach((function(e){w.currentQuest.find((function(r){return r.table_id===e.id})).searcher_status=e.fields.searcher_status,i(Object(m.a)({},w))}))}))}()},children:"\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0432 \u044d\u043a\u0438\u043f\u0430\u0436"})]})]})}var N=t(18),y=t.n(N),C=new h.a({apiKey:"keyHvrSKnN3fo7ORx"}).base("appou4euyZ2UDPPEg"),D=function(){var e=Object(l.f)();var r=new URLSearchParams(Object(l.g)().search).get("quest_id");return Object(u.jsxs)("div",{className:y.a.editSearcher,children:[Object(u.jsxs)("div",{className:y.a.header,children:[Object(u.jsx)("div",{className:y.a.back,onClick:function(){return e.goBack()},children:Object(u.jsx)("img",{src:x,alt:"back"})}),Object(u.jsx)("h1",{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]}),Object(u.jsx)("div",{children:Object(u.jsxs)("form",{className:y.a.form,onSubmit:function(e){return function(e){e.preventDefault();var t=Object.fromEntries(new FormData(e.target)),c=new Date(t.searcher_time).toISOString(),s={quest_id:parseInt(r),searcher_crew:0,searcher_id:parseInt(t.searcher_id),searcher_place:t.searcher_place,searcher_role:[t.searcher_role],searcher_status:"\u0433\u043e\u0442\u043e\u0432",searcher_time:c},a={searcher_id:parseInt(t.searcher_id),searcher_phone:t.searcher_phone,call_sign:t.call_sign};C("CrewMeta").create([{fields:s}],(function(e,r){e?console.error(e):r.forEach((function(e){console.log(e.getId())}))})),C("Searchers").create([{fields:a}],(function(e,r){e?console.error(e):r.forEach((function(e){console.log(e.getId())}))}))}(e)},children:[Object(u.jsxs)("label",{children:["\u041f\u043e\u0437\u044b\u0432\u043d\u043e\u0439:",Object(u.jsx)("input",{type:"text",name:"call_sign"})]}),Object(u.jsxs)("label",{children:["@id:",Object(u.jsx)("input",{type:"number",name:"searcher_id"})]}),Object(u.jsxs)("label",{children:["\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430:",Object(u.jsx)("input",{type:"phone",name:"searcher_phone"})]}),Object(u.jsxs)("label",{children:["\u0410\u0434\u0440\u0435\u0441:",Object(u.jsx)("input",{type:"adress",name:"searcher_place"})]}),Object(u.jsxs)("label",{children:["\u0412\u0440\u0435\u043c\u044f:",Object(u.jsx)("input",{type:"datetime-local",name:"searcher_time"})]}),Object(u.jsxs)("label",{children:["\u0420\u043e\u043b\u044c:",Object(u.jsxs)("select",{name:"searcher_role",children:[Object(u.jsx)("option",{selected:!0,value:"\u043f\u0435\u0448\u0438\u0439",children:"\u041f\u0435\u0448\u0438\u0439"}),Object(u.jsx)("option",{value:"\u043f\u0438\u043b\u043e\u0442",children:"\u041f\u0438\u043b\u043e\u0442"}),Object(u.jsx)("option",{value:"\u0438\u043d\u0444\u043e\u0440\u0433",children:"\u0418\u043d\u0444\u043e\u0440\u0433"}),Object(u.jsx)("option",{value:"\u0441\u043d\u043c",children:"\u0421\u041d\u041c"}),Object(u.jsx)("option",{value:"\u043a\u043e\u043e\u0440\u0434",children:"\u041a\u043e\u043e\u0440\u0434"})]})]}),Object(u.jsx)("input",{type:"submit",value:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})})]})},E=function(){var e=Object(c.useState)(!1),r=Object(o.a)(e,2),t=(r[0],r[1],Object(c.useState)([])),s=Object(o.a)(t,2),a=s[0],n=s[1],d=Object(l.f)(),j=function(e){var r=e.searcher;return Object(u.jsx)("div",{className:f.a.modal,children:Object(u.jsxs)("div",{className:f.a.modalWrapper,children:[Object(u.jsxs)("div",{className:f.a.modalHeader,children:[Object(u.jsx)("h3",{children:r.call_sign}),Object(u.jsx)("div",{className:f.a.modalClose,onClick:function(){return h()},children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]}),Object(u.jsx)("div",{children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441"}),Object(u.jsx)("li",{children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(u.jsx)("li",{children:"\u0412 \u044d\u043a\u0438\u043f\u0430\u0436"}),Object(u.jsx)("li",{children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})})]})})},h=function(e){console.log(a),a[0]?(document.body.style.overflowY="auto",n([!1])):(document.body.style.overflowY="hidden",n([!0,e]))};var b=new URLSearchParams(Object(l.g)().search).get("quest_id");return Object(u.jsxs)("div",{className:f.a.searchers,children:[a[0]&&Object(u.jsx)(j,{searcher:a[1]}),Object(u.jsxs)("div",{className:f.a.header,children:[Object(u.jsx)("div",{className:f.a.back,onClick:function(){return d.goBack()},children:Object(u.jsx)("img",{src:x,alt:"back"})}),Object(u.jsx)("h1",{children:"\u041a\u043e\u043c\u0430\u043d\u0434\u0430"})]}),Object(u.jsx)("div",{className:f.a.addSearcher,children:Object(u.jsx)(i.b,{to:"/edit_searcher?quest_id="+b,children:"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u0438\u043a\u0430"})}),Object(u.jsx)(k,{questID:b,toggleModal:h})]})},P=function(){return Object(u.jsx)(i.a,{children:Object(u.jsxs)(l.c,{children:[Object(u.jsx)(l.a,{path:"/",exact:!0,children:Object(u.jsx)(O,{})}),Object(u.jsx)(l.a,{path:"/crew",children:Object(u.jsx)(E,{})}),Object(u.jsx)(l.a,{path:"/edit_searcher",children:Object(u.jsx)(D,{})})]})})},Q=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,134)).then((function(r){var t=r.getCLS,c=r.getFID,s=r.getFCP,a=r.getLCP,n=r.getTTFB;t(e),c(e),s(e),a(e),n(e)}))};n.a.render(Object(u.jsx)(s.a.StrictMode,{children:Object(u.jsx)(P,{})}),document.getElementById("root")),Q()},18:function(e,r,t){e.exports={editSearcher:"EditSearcher_editSearcher__3CL0J",header:"EditSearcher_header__3W2M0",back:"EditSearcher_back__1FPk1",form:"EditSearcher_form__2m1Xc"}},2:function(e,r,t){e.exports={searchers:"Searchers_searchers__uqCT5",searcher:"Searchers_searcher__QYm_r",separator:"Searchers_separator__1NuHH",searcherHeader:"Searchers_searcherHeader__gbkjb",searcherBody:"Searchers_searcherBody__3K4ol",searcherCallSign:"Searchers_searcherCallSign__1UT5Q",isPilot:"Searchers_isPilot__3zPbe",back:"Searchers_back__OYl4x",status:"Searchers_status__2CxmW",selected:"Searchers_selected__2aUQp",header:"Searchers_header__1P0HM",addSearcher:"Searchers_addSearcher__eFHWo",modal:"Searchers_modal__1p25u",modalWrapper:"Searchers_modalWrapper__1-bsN",modalClose:"Searchers_modalClose__1S60B",modalHeader:"Searchers_modalHeader__2BFWP"}},57:function(e,r,t){}},[[133,1,2]]]);
//# sourceMappingURL=main.57c45a14.chunk.js.map